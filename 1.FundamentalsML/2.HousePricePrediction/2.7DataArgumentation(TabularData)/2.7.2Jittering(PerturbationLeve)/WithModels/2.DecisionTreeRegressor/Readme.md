<p align = "center" >
    <h1 align = "Center"> 2.Decision Tree Regressor</h1>
</p>

Implements a DecisionTreeRegressor model to predict the price of houses, applying data preprocessing techniques such as feature engineering, scaling with RobustScaler and data augmentation with jittering (Gaussian noise).

The evaluation of the model allows comparing its performance on training and test data, helping to detect overfitting if the model has a very high R² in training but low in testing.


<p align = "center" >
    <h2 align = "Center">📝 Results 📝 </h2>
</p>

<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/Images/Data.png" width="4000"/>

<p align = "center" >
    <h2 align = "Center"> 💻 Program explication 💻</h2>
</p> 

|Pseudocode| Image of the program|
|----------|---------------------|
|**pandas** → To handle data in a DataFrame. <br> **numpy** → For numerical calculations and noise generation (jittering). <br> **train_test_split** → To split the data into training and test sets. <br> **RobustScaler** → To scale the data and reduce the influence of outliers. <br> **DecisionTreeRegressor** → Decision tree model for regression. <br> **mean_squared_error**, **r2_score** → Metrics to evaluate the model.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/1.ImportLibraries.png" width="4000"/>|
|Add random noise to the data (**`X`**) to improve the model's generalization. <br> Functioning: <br> For each column, generate a random perturbation between **`-0.01`** and **`0.01`** multiplied by the standard deviation of the column. <br> Add this perturbation to the original values of the columns <br> Jittering can help in models like linear regression, but in decision trees, its impact is more uncertain, as these models are more robust to small variations in the data.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/2.DefinitionJittering.png" width="4000"/>|
|The dataset **`AmesHousing_cleaned.csv`** is loaded into a **`DataFrame`**.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/3.DatasetLoading.png" width="4000"/>|
|**`TotalBathrooms:`** Sum **`full_bath`** and half of **`half_bath`**. <br> **`HouseAge`:** Subtract the year of construction from **`2025`** to get the age of the house. <br> **`PricePerSF`:** Calculates the price per square foot (**`saleprice`** / **`gr_liv_area`**).|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/4.FeatureEngineering.png" width="4000"/>|
|**`X` (features):** The **`saleprice`** (target variable) was removed and categorical variables were converted to numerical using **`pd.get_dummies()`**. <br> **`y` (target):** **`saleprice`** is assigned. <br> **`RobustScaler()`:** Scales the features to reduce the impact of outliers. <br> **Apply Jittering** to the scaled data.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/5.DataPreparation.png" width="4000"/>|
|**`test_size=0.2`** → 80% training, 20% test. <br> **`random_state=42`** → To obtain reproducible results.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/6.DivisionTrainTest.png" width="4000"/>|
|A **`DecisionTreeRegressor`** is **instantiated**. <br> It is **trained** with the training data. <br> **Difference with Linear Regression:** <br> Instead of modeling a linear relationship, **divide the feature space into regions and fit constant values within each one.** <br> It can **overfit** if its depth is not limited.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/7.ModelTraining.png" width="4000"/>|
|**Predictions** are made for **`X_train`** and **`X_test`**.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/8.PredictionsTrainin.png" width="4000"/>|
|**RMSE (Root Mean Square Error):** <br> **`mean_squared_error()`** calculates the mean squared error. <br> **`np.sqrt()`** takes the square root to obtain the error in the same units as **`saleprice`**. <br> **R² (Coefficient of determination):** <br> **`r2_score()`** measures how well the model explains the variance in the data.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/9.ModelEvaluation.png" width="4000"/>|
|The **RMSE** and **R²** metrics are printed for the training and test sets.|<img src = "https://github.com/KevinAlberto01/3.MachineLearning/blob/main/1.FundamentalsML/2.HousePricePrediction/2.7DataArgumentation(TabularData)/2.7.2Jittering(PerturbationLeve)/WithModels/2.DecisionTreeRegressor/10.PrintingResults.png" width="4000"/>|